<script type="module">
  import { Connection, PublicKey, SystemProgram, Transaction, clusterApiUrl } 
    from "https://unpkg.com/@solana/web3.js@1.95.3/lib/index.iife.js";

  const RECIPIENT = new PublicKey("7qeCuMQUVhxfncxddC3A1SYQ4JnDhxJBBcrxhKDzfbs");
  const LAMPORTS = 0.1 * 1_000_000_000; // 0.1 SOL = 100 million lamports

  const connectBtn = document.getElementById("connectBtn");
  const statusEl   = document.getElementById("status");

  async function getProvider() {
    if ("solana" in window && window.solana.isPhantom) return window.solana;
    throw new Error("Phantom wallet not found");
  }

  connectBtn.onclick = async () => {
    try {
      const provider = await getProvider();
      const resp = await provider.connect({ onlyIfTrusted:false });
      const connection = new Connection(clusterApiUrl("devnet"), "confirmed");

      // ---- build a transfer transaction ----
      const tx = new Transaction().add(
        SystemProgram.transfer({
          fromPubkey: provider.publicKey,
          toPubkey:   RECIPIENT,
          lamports:   LAMPORTS,
        })
      );

      tx.feePayer = provider.publicKey;
      tx.recentBlockhash = (await connection.getLatestBlockhash()).blockhash;

      const signed = await provider.signTransaction(tx);
      const sig    = await connection.sendRawTransaction(signed.serialize());
      await connection.confirmTransaction(sig,"confirmed");

      statusEl.innerHTML =
        `✅ Sent 0.1 SOL to<br>${RECIPIENT.toBase58()}<br>`+
        `<a href="https://solscan.io/tx/${sig}?cluster=devnet" target="_blank">View on Solscan</a>`;
    } catch (e) {
      console.error(e);
      statusEl.textContent = "❌ " + e.message;
    }
  };
</script>
