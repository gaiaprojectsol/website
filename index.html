<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Send 0.1 SOL with Memo</title>
  <script type="module">
    import { Connection, PublicKey, SystemProgram, Transaction } from "https://esm.sh/@solana/web3.js@1.95.3";
    import { createMemoInstruction } from "https://esm.sh/@solana/spl-memo@0.1.3";

    const connection = new Connection("https://api.mainnet-beta.solana.com"); // or use devnet for testing
    const recipient = new PublicKey("7qeCuMQUVhxfncxddC3A1SYQ4JnDhxJBBcrxhKDzfbs");

    async function connectWallet() {
      const provider = window.solana;
      if (!provider?.isPhantom) {
        alert("Phantom Wallet not found. Please install it!");
        return null;
      }
      await provider.connect();
      document.getElementById("wallet-status").textContent = "Wallet connected ✅";
      return provider;
    }

    async function sendSol() {
      const provider = await connectWallet();
      if (!provider) return;

      const memoText = document.getElementById("memo").value.trim();
      if (!memoText) return alert("Please enter a memo!");

      const tx = new Transaction();

      // 1) Add transfer instruction (0.1 SOL)
      tx.add(
        SystemProgram.transfer({
          fromPubkey: provider.publicKey,
          toPubkey: recipient,
          lamports: 0.1 * 1e9, // 0.1 SOL
        })
      );

      // 2) Add memo instruction
      tx.add(createMemoInstruction(memoText));

      // 3) Send the transaction
      tx.feePayer = provider.publicKey;
      tx.recentBlockhash = (await connection.getLatestBlockhash()).blockhash;

      const signed = await provider.signTransaction(tx);
      const sig = await connection.sendRawTransaction(signed.serialize());
      await connection.confirmTransaction(sig, "confirmed");

      alert(`Transaction successful!\nSignature: ${sig}`);
    }

    window.sendSol = sendSol;
  </script>
</head>
<body style="font-family:sans-serif; text-align:center; margin-top:50px;">
  <h2>Send 0.1 SOL with a Memo</h2>
  <p id="wallet-status">Wallet not connected ❌</p>
  <input id="memo" type="text" placeholder="What would you like to call your genean (e.g. Torvalds)" style="padding:8px; width:250px;">
  <br><br>
  <button onclick="sendSol()" style="padding:10px 20px; font-size:16px;">Send 0.1 SOL</button>
</body>
</html>
